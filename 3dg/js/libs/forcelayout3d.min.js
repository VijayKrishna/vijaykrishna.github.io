!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.ngraph=t()}}(function(){return function t(n,e,r){function o(s,a){if(!e[s]){if(!n[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);var f=new Error("Cannot find module '"+s+"'");throw f.code="MODULE_NOT_FOUND",f}var p=e[s]={exports:{}};n[s][0].call(p.exports,function(t){var e=n[s][1][t];return o(e?e:t)},p,p.exports,t,n,e,r)}return e[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(t,n,e){n.exports={graph:t("ngraph.graph"),forcelayout3d:t("ngraph.forcelayout3d")}},{"ngraph.forcelayout3d":2,"ngraph.graph":30}],2:[function(t,n,e){function r(n,e){var i=t("ngraph.merge");return e=i(e,{createQuadTree:t("ngraph.quadtreebh3d"),createBounds:t("./lib/bounds"),createDragForce:t("./lib/dragForce"),createSpringForce:t("./lib/springForce"),integrator:o(e),createBody:t("./lib/createBody")}),r.get2dLayout(n,e)}function o(n){return t(n&&"verlet"===n.integrator?"./lib/verletIntegrator.js":"./lib/eulerIntegrator")}n.exports=r,r.get2dLayout=t("ngraph.forcelayout")},{"./lib/bounds":3,"./lib/createBody":4,"./lib/dragForce":5,"./lib/eulerIntegrator":6,"./lib/springForce":7,"./lib/verletIntegrator.js":8,"ngraph.forcelayout":10,"ngraph.merge":23,"ngraph.quadtreebh3d":25}],3:[function(t,n,e){n.exports=function(n,e){function r(){var t=n.length;if(0!==t){for(var e=Number.MAX_VALUE,r=Number.MAX_VALUE,o=Number.MAX_VALUE,s=Number.MIN_VALUE,a=Number.MIN_VALUE,u=Number.MIN_VALUE;t--;){var f=n[t];f.isPinned?(f.pos.x=f.prevPos.x,f.pos.y=f.prevPos.y,f.pos.z=f.prevPos.z):(f.prevPos.x=f.pos.x,f.prevPos.y=f.pos.y,f.prevPos.z=f.pos.z),f.pos.x<e&&(e=f.pos.x),f.pos.x>s&&(s=f.pos.x),f.pos.y<r&&(r=f.pos.y),f.pos.y>a&&(a=f.pos.y),f.pos.z<o&&(o=f.pos.z),f.pos.z>u&&(u=f.pos.z)}i.x1=e,i.x2=s,i.y1=r,i.y2=a,i.z1=o,i.z2=u}}var o=t("ngraph.random").random(42),i={x1:0,y1:0,z1:0,x2:0,y2:0,z2:0};return{box:i,update:r,reset:function(){i.x1=i.y1=0,i.x2=i.y2=0,i.z1=i.z2=0},getBestNewPosition:function(t){var n=i,r=0,s=0,a=0;if(t.length){for(var u=0;u<t.length;++u)r+=t[u].pos.x,s+=t[u].pos.y,a+=t[u].pos.z;r/=t.length,s/=t.length,a/=t.length}else r=(n.x1+n.x2)/2,s=(n.y1+n.y2)/2,a=(n.z1+n.z2)/2;var f=e.springLength;return{x:r+o.next(f)-f/2,y:s+o.next(f)-f/2,z:a+o.next(f)-f/2}}}}},{"ngraph.random":29}],4:[function(t,n,e){var r=t("ngraph.physics.primitives");n.exports=function(t){return new r.Body3d(t)}},{"ngraph.physics.primitives":24}],5:[function(t,n,e){n.exports=function(n){var e=t("ngraph.merge"),r=t("ngraph.expose");n=e(n,{dragCoeff:.02});var o={update:function(t){t.force.x-=n.dragCoeff*t.velocity.x,t.force.y-=n.dragCoeff*t.velocity.y,t.force.z-=n.dragCoeff*t.velocity.z}};return r(n,o,["dragCoeff"]),o}},{"ngraph.expose":9,"ngraph.merge":23}],6:[function(t,n,e){function r(t,n){var e,r=0,o=0,i=0,s=0,a=0,u=0,f=t.length;for(e=0;e<f;++e){var p=t[e],c=n/p.mass;p.velocity.x+=c*p.force.x,p.velocity.y+=c*p.force.y,p.velocity.z+=c*p.force.z;var d=p.velocity.x,h=p.velocity.y,l=p.velocity.z,y=Math.sqrt(d*d+h*h+l*l);y>1&&(p.velocity.x=d/y,p.velocity.y=h/y,p.velocity.z=l/y),r=n*p.velocity.x,i=n*p.velocity.y,a=n*p.velocity.z,p.pos.x+=r,p.pos.y+=i,p.pos.z+=a,o+=Math.abs(r),s+=Math.abs(i),u+=Math.abs(a)}return(o*o+s*s+u*u)/t.length}n.exports=r},{}],7:[function(t,n,e){n.exports=function(n){var e=t("ngraph.merge"),r=t("ngraph.random").random(42),o=t("ngraph.expose");n=e(n,{springCoeff:2e-4,springLength:80});var i={update:function(t){var e=t.from,o=t.to,i=t.length<0?n.springLength:t.length,s=o.pos.x-e.pos.x,a=o.pos.y-e.pos.y,u=o.pos.z-e.pos.z,f=Math.sqrt(s*s+a*a+u*u);0===f&&(s=(r.nextDouble()-.5)/50,a=(r.nextDouble()-.5)/50,u=(r.nextDouble()-.5)/50,f=Math.sqrt(s*s+a*a+u*u));var p=f-i,c=(!t.coeff||t.coeff<0?n.springCoeff:t.coeff)*p/f*t.weight;e.force.x+=c*s,e.force.y+=c*a,e.force.z+=c*u,o.force.x-=c*s,o.force.y-=c*a,o.force.z-=c*u}};return o(n,i,["springCoeff","springLength"]),i}},{"ngraph.expose":9,"ngraph.merge":23,"ngraph.random":29}],8:[function(t,n,e){function r(t,n){var e,r=0,o=0,i=0,s=t.length;for(e=0;e<s;++e){var a=t[e],u=n*n/a.mass;a.pos.x=2*a.pos.x-a.prevPos.x+a.force.x*u,a.pos.y=2*a.pos.y-a.prevPos.y+a.force.y*u,a.pos.z=2*a.pos.z-a.prevPos.z+a.force.z*u,r+=Math.abs(a.pos.x-a.prevPos.x),o+=Math.abs(a.pos.y-a.prevPos.y),i+=Math.abs(a.pos.z-a.prevPos.z)}return(r*r+o*o+i*i)/t.length}n.exports=r},{}],9:[function(t,n,e){function r(t,n,e){var r="[object Array]"===Object.prototype.toString.call(e);if(r)for(var i=0;i<e.length;++i)o(t,n,e[i]);else for(var s in t)o(t,n,s)}function o(t,n,e){if(t.hasOwnProperty(e)){if("function"==typeof n[e])return;n[e]=function(r){return void 0!==r?(t[e]=r,n):t[e]}}}n.exports=r},{}],10:[function(t,n,e){function r(n,e){function r(t,e){var r;if(void 0===e)r="object"!=typeof t?t:t.id;else{var o=n.hasLink(t,e);if(!o)return;r=o.id}return w[r]}function s(t){return k[t]}function a(){n.on("changed",f),q.on("stable",u)}function u(t){M.fire("stable",t)}function f(t){for(var n=0;n<t.length;++n){var e=t[n];"add"===e.changeType?(e.node&&c(e.node.id),e.link&&h(e.link)):"remove"===e.changeType&&(e.node&&d(e.node),e.link&&l(e.link))}}function p(){n.forEachNode(function(t){c(t.id)}),n.forEachLink(h)}function c(t){var e=k[t];if(!e){var r=n.getNode(t);if(!r)throw new Error("initBody() was called with unknown node id");var o=r.position;if(!o){var i=y(r);o=q.getBestNewBodyPosition(i)}e=q.addBodyAt(o),k[t]=e,g(t),v(r)&&(e.isPinned=!0)}}function d(t){var n=t.id,e=k[n];e&&(k[n]=null,delete k[n],q.removeBody(e))}function h(t){g(t.fromId),g(t.toId);var n=k[t.fromId],e=k[t.toId],r=q.addSpring(n,e,t.length);I(t,r),w[t.id]=r}function l(t){var e=w[t.id];if(e){var r=n.getNode(t.fromId),o=n.getNode(t.toId);r&&g(r.id),o&&g(o.id),delete w[t.id],q.removeSpring(e)}}function y(t){var n=[];if(!t.links)return n;for(var e=Math.min(t.links.length,2),r=0;r<e;++r){var o=t.links[r],i=o.fromId!==t.id?k[o.fromId]:k[o.toId];i&&i.pos&&n.push(i)}return n}function g(t){var n=k[t];n.mass=m(t)}function v(t){return t&&(t.isPinned||t.data&&t.data.isPinned)}function x(t){var n=k[t];return n||(c(t),n=k[t]),n}function m(t){var e=n.getLinks(t);return e?1+e.length/3:1}if(!n)throw new Error("Graph structure cannot be undefined");var b=t("ngraph.physics.simulator"),q=b(e),k="function"==typeof Object.create?Object.create(null):{},w={},I=q.settings.springTransform||o;p(),a();var M={step:function(){return q.step()},getNodePosition:function(t){return x(t).pos},setNodePosition:function(t){var n=x(t);n.setPosition.apply(n,Array.prototype.slice.call(arguments,1))},getLinkPosition:function(t){var n=w[t];if(n)return{from:n.from.pos,to:n.to.pos}},getGraphRect:function(){return q.getBBox()},pinNode:function(t,n){var e=x(t.id);e.isPinned=!!n},isNodePinned:function(t){return x(t.id).isPinned},dispose:function(){n.off("changed",f),q.off("stable",u)},getBody:s,getSpring:r,simulator:q};return i(M),M}function o(){}n.exports=r,n.exports.simulator=t("ngraph.physics.simulator");var i=t("ngraph.events")},{"ngraph.events":11,"ngraph.physics.simulator":12}],11:[function(t,n,e){function r(t){var n=Object.create(null);return{on:function(e,r,o){if("function"!=typeof r)throw new Error("callback is expected to be a function");var i=n[e];return i||(i=n[e]=[]),i.push({callback:r,ctx:o}),t},off:function(e,r){var o="undefined"==typeof e;if(o)return n=Object.create(null),t;if(n[e]){var i="function"!=typeof r;if(i)delete n[e];else for(var s=n[e],a=0;a<s.length;++a)s[a].callback===r&&s.splice(a,1)}return t},fire:function(e){var r=n[e];if(!r)return t;var o;arguments.length>1&&(o=Array.prototype.splice.call(arguments,1));for(var i=0;i<r.length;++i){var s=r[i];s.callback.apply(s.ctx,o)}return t}}}function o(t){if(!t)throw new Error("Eventify cannot use falsy object as events subject");for(var n=["on","fire","off"],e=0;e<n.length;++e)if(t.hasOwnProperty(n[e]))throw new Error("Subject cannot be eventified, since it already has property '"+n[e]+"'")}n.exports=function(t){o(t);var n=r(t);return t.on=n.on,t.off=n.off,t.fire=n.fire,t}},{}],12:[function(t,n,e){function r(n){function e(){var t,n=h.length;if(n)for(y.insertBodies(h);n--;)t=h[n],t.isPinned||(t.force.reset(),y.updateBodyForce(t),x.update(t));for(n=l.length;n--;)v.update(l[n])}var r=t("./lib/spring"),o=t("ngraph.expose"),i=t("ngraph.merge"),s=t("ngraph.events");n=i(n,{springLength:30,springCoeff:8e-4,gravity:-1.2,theta:.8,dragCoeff:.02,timeStep:20,stableThreshold:.009});var a=n.createQuadTree||t("ngraph.quadtreebh"),u=n.createBounds||t("./lib/bounds"),f=n.createDragForce||t("./lib/dragForce"),p=n.createSpringForce||t("./lib/springForce"),c=n.integrator||t("./lib/eulerIntegrator"),d=n.createBody||t("./lib/createBody"),h=[],l=[],y=a(n),g=u(h,n),v=p(n),x=f(n),m=0,b=!1,q={bodies:h,springs:l,settings:n,step:function(){e(),m=c(h,n.timeStep),g.update();var t=m<n.stableThreshold;return b!==t&&q.fire("stable",t),b=t,t},addBody:function(t){if(!t)throw new Error("Body is required");return h.push(t),t},addBodyAt:function(t){if(!t)throw new Error("Body position is required");var n=d(t);return h.push(n),n},removeBody:function(t){if(t){var n=h.indexOf(t);if(!(n<0))return h.splice(n,1),0===h.length&&g.reset(),!0}},addSpring:function(t,n,e,o,i){if(!t||!n)throw new Error("Cannot add null spring to force simulator");"number"!=typeof e&&(e=-1);var s=new r(t,n,e,i>=0?i:-1,o);return l.push(s),s},getTotalMovement:function(){return m},removeSpring:function(t){if(t){var n=l.indexOf(t);return n>-1?(l.splice(n,1),!0):void 0}},getBestNewBodyPosition:function(t){return g.getBestNewPosition(t)},getBBox:function(){return g.box},gravity:function(t){return void 0!==t?(n.gravity=t,y.options({gravity:t}),this):n.gravity},theta:function(t){return void 0!==t?(n.theta=t,y.options({theta:t}),this):n.theta}};return o(n,q),s(q),q}n.exports=r},{"./lib/bounds":13,"./lib/createBody":14,"./lib/dragForce":15,"./lib/eulerIntegrator":16,"./lib/spring":17,"./lib/springForce":18,"ngraph.events":11,"ngraph.expose":9,"ngraph.merge":23,"ngraph.quadtreebh":19}],13:[function(t,n,e){n.exports=function(n,e){function r(){var t=n.length;if(0!==t){for(var e=Number.MAX_VALUE,r=Number.MAX_VALUE,o=Number.MIN_VALUE,s=Number.MIN_VALUE;t--;){var a=n[t];a.isPinned?(a.pos.x=a.prevPos.x,a.pos.y=a.prevPos.y):(a.prevPos.x=a.pos.x,a.prevPos.y=a.pos.y),a.pos.x<e&&(e=a.pos.x),a.pos.x>o&&(o=a.pos.x),a.pos.y<r&&(r=a.pos.y),a.pos.y>s&&(s=a.pos.y)}i.x1=e,i.x2=o,i.y1=r,i.y2=s}}var o=t("ngraph.random").random(42),i={x1:0,y1:0,x2:0,y2:0};return{box:i,update:r,reset:function(){i.x1=i.y1=0,i.x2=i.y2=0},getBestNewPosition:function(t){var n=i,r=0,s=0;if(t.length){for(var a=0;a<t.length;++a)r+=t[a].pos.x,s+=t[a].pos.y;r/=t.length,s/=t.length}else r=(n.x1+n.x2)/2,s=(n.y1+n.y2)/2;var u=e.springLength;return{x:r+o.next(u)-u/2,y:s+o.next(u)-u/2}}}}},{"ngraph.random":29}],14:[function(t,n,e){var r=t("ngraph.physics.primitives");n.exports=function(t){return new r.Body(t)}},{"ngraph.physics.primitives":24}],15:[function(t,n,e){n.exports=function(n){var e=t("ngraph.merge"),r=t("ngraph.expose");n=e(n,{dragCoeff:.02});var o={update:function(t){t.force.x-=n.dragCoeff*t.velocity.x,t.force.y-=n.dragCoeff*t.velocity.y}};return r(n,o,["dragCoeff"]),o}},{"ngraph.expose":9,"ngraph.merge":23}],16:[function(t,n,e){function r(t,n){var e,r=0,o=0,i=0,s=0,a=t.length;if(0===a)return 0;for(e=0;e<a;++e){var u=t[e],f=n/u.mass;u.velocity.x+=f*u.force.x,u.velocity.y+=f*u.force.y;var p=u.velocity.x,c=u.velocity.y,d=Math.sqrt(p*p+c*c);d>1&&(u.velocity.x=p/d,u.velocity.y=c/d),r=n*u.velocity.x,i=n*u.velocity.y,u.pos.x+=r,u.pos.y+=i,o+=Math.abs(r),s+=Math.abs(i)}return(o*o+s*s)/a}n.exports=r},{}],17:[function(t,n,e){function r(t,n,e,r,o){this.from=t,this.to=n,this.length=e,this.coeff=r,this.weight="number"==typeof o?o:1}n.exports=r},{}],18:[function(t,n,e){n.exports=function(n){var e=t("ngraph.merge"),r=t("ngraph.random").random(42),o=t("ngraph.expose");n=e(n,{springCoeff:2e-4,springLength:80});var i={update:function(t){var e=t.from,o=t.to,i=t.length<0?n.springLength:t.length,s=o.pos.x-e.pos.x,a=o.pos.y-e.pos.y,u=Math.sqrt(s*s+a*a);0===u&&(s=(r.nextDouble()-.5)/50,a=(r.nextDouble()-.5)/50,u=Math.sqrt(s*s+a*a));var f=u-i,p=(!t.coeff||t.coeff<0?n.springCoeff:t.coeff)*f/u*t.weight;e.force.x+=p*s,e.force.y+=p*a,o.force.x-=p*s,o.force.y-=p*a}};return o(n,i,["springCoeff","springLength"]),i}},{"ngraph.expose":9,"ngraph.merge":23,"ngraph.random":29}],19:[function(t,n,e){function r(t,n){return 0===n?t.quad0:1===n?t.quad1:2===n?t.quad2:3===n?t.quad3:null}function o(t,n,e){0===n?t.quad0=e:1===n?t.quad1=e:2===n?t.quad2=e:3===n&&(t.quad3=e)}n.exports=function(n){n=n||{},n.gravity="number"==typeof n.gravity?n.gravity:-1,n.theta="number"==typeof n.theta?n.theta:.8;var e=t("ngraph.random").random(1984),i=t("./node"),s=t("./insertStack"),a=t("./isSamePosition"),u=n.gravity,f=[],p=new s,c=n.theta,d=[],h=0,l=function(){var t=d[h];return t?(t.quad0=null,t.quad1=null,t.quad2=null,t.quad3=null,t.body=null,t.mass=t.massX=t.massY=0,t.left=t.right=t.top=t.bottom=0):(t=new i,d[h]=t),++h,t},y=l(),g=function(t){for(p.reset(),p.push(y,t);!p.isEmpty();){var n=p.pop(),i=n.node,s=n.body;if(i.body){var u=i.body;if(i.body=null,a(u.pos,s.pos)){var f=3;do{var c=e.nextDouble(),d=(i.right-i.left)*c,h=(i.bottom-i.top)*c;u.pos.x=i.left+d,u.pos.y=i.top+h,f-=1}while(f>0&&a(u.pos,s.pos));if(0===f&&a(u.pos,s.pos))return}p.push(i,u),p.push(i,s)}else{var g=s.pos.x,v=s.pos.y;i.mass=i.mass+s.mass,i.massX=i.massX+s.mass*g,i.massY=i.massY+s.mass*v;var x=0,m=i.left,b=(i.right+m)/2,q=i.top,k=(i.bottom+q)/2;if(g>b){x+=1;var w=m;m=b,b+=b-w}if(v>k){x+=2;var I=q;q=k,k+=k-I}var M=r(i,x);M?p.push(M,s):(M=l(),M.left=m,M.top=q,M.right=b,M.bottom=k,M.body=s,o(i,x,M))}}},v=function(t){var n,r,o,i,s=f,a=0,p=0,d=1,h=0,l=1;for(s[0]=y;d;){var g=s[h],v=g.body;d-=1,h+=1;var x=v!==t;v&&x?(r=v.pos.x-t.pos.x,o=v.pos.y-t.pos.y,i=Math.sqrt(r*r+o*o),0===i&&(r=(e.nextDouble()-.5)/50,o=(e.nextDouble()-.5)/50,i=Math.sqrt(r*r+o*o)),n=u*v.mass*t.mass/(i*i*i),a+=n*r,p+=n*o):x&&(r=g.massX/g.mass-t.pos.x,o=g.massY/g.mass-t.pos.y,i=Math.sqrt(r*r+o*o),0===i&&(r=(e.nextDouble()-.5)/50,o=(e.nextDouble()-.5)/50,i=Math.sqrt(r*r+o*o)),(g.right-g.left)/i<c?(n=u*g.mass*t.mass/(i*i*i),a+=n*r,p+=n*o):(g.quad0&&(s[l]=g.quad0,d+=1,l+=1),g.quad1&&(s[l]=g.quad1,d+=1,l+=1),g.quad2&&(s[l]=g.quad2,d+=1,l+=1),g.quad3&&(s[l]=g.quad3,d+=1,l+=1)))}t.force.x+=a,t.force.y+=p},x=function(t){var n,e=Number.MAX_VALUE,r=Number.MAX_VALUE,o=Number.MIN_VALUE,i=Number.MIN_VALUE,s=t.length;for(n=s;n--;){var a=t[n].pos.x,u=t[n].pos.y;a<e&&(e=a),a>o&&(o=a),u<r&&(r=u),u>i&&(i=u)}var f=o-e,p=i-r;for(f>p?i=r+f:o=e+p,h=0,y=l(),y.left=e,y.right=o,y.top=r,y.bottom=i,n=s-1,n>0&&(y.body=t[n]);n--;)g(t[n],y)};return{insertBodies:x,updateBodyForce:v,options:function(t){return t?("number"==typeof t.gravity&&(u=t.gravity),"number"==typeof t.theta&&(c=t.theta),this):{gravity:u,theta:c}}}}},{"./insertStack":20,"./isSamePosition":21,"./node":22,"ngraph.random":29}],20:[function(t,n,e){function r(){this.stack=[],this.popIdx=0}function o(t,n){this.node=t,this.body=n}n.exports=r,r.prototype={isEmpty:function(){return 0===this.popIdx},push:function(t,n){var e=this.stack[this.popIdx];e?(e.node=t,e.body=n):this.stack[this.popIdx]=new o(t,n),++this.popIdx},pop:function(){if(this.popIdx>0)return this.stack[--this.popIdx]},reset:function(){this.popIdx=0}}},{}],21:[function(t,n,e){n.exports=function(t,n){var e=Math.abs(t.x-n.x),r=Math.abs(t.y-n.y);return e<1e-8&&r<1e-8}},{}],22:[function(t,n,e){n.exports=function(){this.body=null,this.quad0=null,this.quad1=null,this.quad2=null,this.quad3=null,this.mass=0,this.massX=0,this.massY=0,this.left=0,this.top=0,this.bottom=0,this.right=0}},{}],23:[function(t,n,e){function r(t,n){var e;if(t||(t={}),n)for(e in n)if(n.hasOwnProperty(e)){var o=t.hasOwnProperty(e),i=typeof n[e],s=!o||typeof t[e]!==i;s?t[e]=n[e]:"object"===i&&(t[e]=r(t[e],n[e]))}return t}n.exports=r},{}],24:[function(t,n,e){function r(t,n){this.pos=new o(t,n),this.prevPos=new o(t,n),this.force=new o,this.velocity=new o,this.mass=1}function o(t,n){t&&"number"!=typeof t?(this.x="number"==typeof t.x?t.x:0,this.y="number"==typeof t.y?t.y:0):(this.x="number"==typeof t?t:0,this.y="number"==typeof n?n:0)}function i(t,n,e){this.pos=new s(t,n,e),this.prevPos=new s(t,n,e),this.force=new s,this.velocity=new s,this.mass=1}function s(t,n,e){t&&"number"!=typeof t?(this.x="number"==typeof t.x?t.x:0,this.y="number"==typeof t.y?t.y:0,this.z="number"==typeof t.z?t.z:0):(this.x="number"==typeof t?t:0,this.y="number"==typeof n?n:0,this.z="number"==typeof e?e:0)}n.exports={Body:r,Vector2d:o,Body3d:i,Vector3d:s},r.prototype.setPosition=function(t,n){this.prevPos.x=this.pos.x=t,this.prevPos.y=this.pos.y=n},o.prototype.reset=function(){this.x=this.y=0},i.prototype.setPosition=function(t,n,e){this.prevPos.x=this.pos.x=t,this.prevPos.y=this.pos.y=n,this.prevPos.z=this.pos.z=e},s.prototype.reset=function(){this.x=this.y=this.z=0}},{}],25:[function(t,n,e){function r(t,n){return 0===n?t.quad0:1===n?t.quad1:2===n?t.quad2:3===n?t.quad3:4===n?t.quad4:5===n?t.quad5:6===n?t.quad6:7===n?t.quad7:null}function o(t,n,e){0===n?t.quad0=e:1===n?t.quad1=e:2===n?t.quad2=e:3===n?t.quad3=e:4===n?t.quad4=e:5===n?t.quad5=e:6===n?t.quad6=e:7===n&&(t.quad7=e)}n.exports=function(n){n=n||{},n.gravity="number"==typeof n.gravity?n.gravity:-1,n.theta="number"==typeof n.theta?n.theta:.8;var e=t("ngraph.random").random(1984),i=t("./node"),s=t("./insertStack"),a=t("./isSamePosition"),u=n.gravity,f=[],p=new s,c=n.theta,d=[],h=0,l=function(){var t=d[h];return t?(t.quad0=null,t.quad4=null,t.quad1=null,t.quad5=null,t.quad2=null,t.quad6=null,t.quad3=null,t.quad7=null,t.body=null,t.mass=t.massX=t.massY=t.massZ=0,t.left=t.right=t.top=t.bottom=t.front=t.back=0):(t=new i,d[h]=t),++h,t},y=l(),g=function(t){for(p.reset(),p.push(y,t);!p.isEmpty();){var n=p.pop(),i=n.node,s=n.body;if(i.body){var u=i.body;if(i.body=null,a(u.pos,s.pos)){var f=3;do{var c=e.nextDouble(),d=(i.right-i.left)*c,h=(i.bottom-i.top)*c,g=(i.front-i.back)*c;u.pos.x=i.left+d,u.pos.y=i.top+h,u.pos.z=i.back+g,f-=1}while(f>0&&a(u.pos,s.pos));if(0===f&&a(u.pos,s.pos))return}p.push(i,u),p.push(i,s)}else{var v=s.pos.x,x=s.pos.y,m=s.pos.z;i.mass+=s.mass,i.massX+=s.mass*v,i.massY+=s.mass*x,i.massZ+=s.mass*m;var b=0,q=i.left,k=(i.right+q)/2,w=i.top,I=(i.bottom+w)/2,M=i.back,P=(i.front+M)/2;if(v>k){b+=1;var z=q;q=k,k+=k-z}if(x>I){b+=2;var N=w;w=I,I+=I-N}if(m>P){b+=4;var L=M;M=P,P=M+(M-L)}var E=r(i,b);E?p.push(E,s):(E=l(),E.left=q,E.top=w,E.right=k,E.bottom=I,E.back=M,E.front=P,E.body=s,o(i,b,E))}}},v=function(t){var n,r,o,i,s,a=f,p=0,d=0,h=0,l=1,g=0,v=1;for(a[0]=y;l;){var x=a[g],m=x.body;l-=1,g+=1;var b=m!==t;m&&b?(r=m.pos.x-t.pos.x,o=m.pos.y-t.pos.y,i=m.pos.z-t.pos.z,s=Math.sqrt(r*r+o*o+i*i),0===s&&(r=(e.nextDouble()-.5)/50,o=(e.nextDouble()-.5)/50,i=(e.nextDouble()-.5)/50,s=Math.sqrt(r*r+o*o+i*i)),n=u*m.mass*t.mass/(s*s*s),p+=n*r,d+=n*o,h+=n*i):b&&(r=x.massX/x.mass-t.pos.x,o=x.massY/x.mass-t.pos.y,i=x.massZ/x.mass-t.pos.z,s=Math.sqrt(r*r+o*o+i*i),0===s&&(r=(e.nextDouble()-.5)/50,o=(e.nextDouble()-.5)/50,i=(e.nextDouble()-.5)/50,s=Math.sqrt(r*r+o*o+i*i)),(x.right-x.left)/s<c?(n=u*x.mass*t.mass/(s*s*s),p+=n*r,d+=n*o,h+=n*i):(x.quad0&&(a[v]=x.quad0,l+=1,v+=1),x.quad1&&(a[v]=x.quad1,l+=1,v+=1),x.quad2&&(a[v]=x.quad2,l+=1,v+=1),x.quad3&&(a[v]=x.quad3,l+=1,v+=1),x.quad4&&(a[v]=x.quad4,l+=1,v+=1),x.quad5&&(a[v]=x.quad5,l+=1,v+=1),x.quad6&&(a[v]=x.quad6,l+=1,v+=1),x.quad7&&(a[v]=x.quad7,l+=1,v+=1)))}t.force.x+=p,t.force.y+=d,t.force.z+=h},x=function(t){var n,e=Number.MAX_VALUE,r=Number.MAX_VALUE,o=Number.MAX_VALUE,i=Number.MIN_VALUE,s=Number.MIN_VALUE,a=Number.MIN_VALUE,u=t.length;for(n=u;n--;){var f=t[n].pos,p=f.x,c=f.y,d=f.z;p<e&&(e=p),p>i&&(i=p),c<r&&(r=c),c>s&&(s=c),d<o&&(o=d),d>a&&(a=d)}var v=Math.max(i-e,Math.max(s-r,a-o));for(i=e+v,s=r+v,a=o+v,h=0,y=l(),y.left=e,y.right=i,y.top=r,y.bottom=s,y.back=o,y.front=a,n=u-1,n>0&&(y.body=t[n]);n--;)g(t[n],y)};return{insertBodies:x,updateBodyForce:v,options:function(t){return t?("number"==typeof t.gravity&&(u=t.gravity),"number"==typeof t.theta&&(c=t.theta),this):{gravity:u,theta:c}}}}},{"./insertStack":26,"./isSamePosition":27,"./node":28,"ngraph.random":29}],26:[function(t,n,e){function r(){this.stack=[],this.popIdx=0}function o(t,n){this.node=t,this.body=n}n.exports=r,r.prototype={isEmpty:function(){return 0===this.popIdx},push:function(t,n){var e=this.stack[this.popIdx];e?(e.node=t,e.body=n):this.stack[this.popIdx]=new o(t,n),++this.popIdx},pop:function(){if(this.popIdx>0)return this.stack[--this.popIdx]},reset:function(){this.popIdx=0}}},{}],27:[function(t,n,e){n.exports=function(t,n){var e=Math.abs(t.x-n.x),r=Math.abs(t.y-n.y),o=Math.abs(t.z-n.z);return e<1e-8&&r<1e-8&&o<1e-8}},{}],28:[function(t,n,e){n.exports=function(){this.body=null,this.quad0=null,this.quad1=null,this.quad2=null,this.quad3=null,this.quad4=null,this.quad5=null,this.quad6=null,this.quad7=null,this.mass=0,this.massX=0,this.massY=0,this.massZ=0,this.left=0,this.top=0,this.bottom=0,this.right=0,this.front=0,this.back=0}},{}],29:[function(t,n,e){function r(t){var n="number"==typeof t?t:+new Date,e=function(){return n=n+2127912214+(n<<12)&4294967295,n=4294967295&(3345072700^n^n>>>19),n=n+374761393+(n<<5)&4294967295,n=4294967295&(n+3550635116^n<<9),n=n+4251993797+(n<<3)&4294967295,n=4294967295&(3042594569^n^n>>>16),(268435455&n)/268435456};return{next:function(t){return Math.floor(e()*t)},nextDouble:function(){return e()}}}function o(t,n){var e=n||r();if("function"!=typeof e.next)throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:function(n){var r,o,i;for(r=t.length-1;r>0;--r)o=e.next(r+1),i=t[o],t[o]=t[r],t[r]=i,n(i);t.length&&n(t[0])},shuffle:function(){var n,r,o;for(n=t.length-1;n>0;--n)r=e.next(n+1),o=t[r],t[r]=t[n],t[n]=o;return t}}}n.exports={random:r,randomIterator:o}},{}],30:[function(t,n,e){function r(t){function n(){function t(){return F.beginUpdate=X=M,F.endUpdate=j=P,O=e,S=r,F.on=n,n.apply(F,arguments)}var n=F.on;F.on=t}function e(t,n){_.push({link:t,changeType:n})}function r(t,n){_.push({node:t,changeType:n})}function u(t,n){if(void 0===t)throw new Error("Invalid node identifier");X();var e=c(t);return e?S(e,"update"):(e=new i(t),U++,S(e,"add")),e.data=n,E[t]=e,j(),e}function c(t){return E[t]}function d(t){var n=c(t);if(!n)return!1;if(X(),n.links)for(;n.links.length;){var e=n.links[0];v(e)}return delete E[t],U--,S(n,"remove"),j(),!0}function h(t,n,e){X();var r=c(t)||u(t),o=c(n)||u(n),i=V(t,n,e);return B.push(i),s(r,i),t!==n&&s(o,i),O(i,"add"),j(),i}function l(t,n,e){var r=f(t,n);return new a(t,n,e,r)}function y(t,n,e){var r=f(t,n),o=A.hasOwnProperty(r);if(o||x(t,n)){o||(A[r]=0);var i="@"+ ++A[r];r=f(t+i,n+i)}return new a(t,n,e,r)}function g(t){var n=c(t);return n?n.links:null}function v(t){if(!t)return!1;var n=o(t,B);if(n<0)return!1;X(),B.splice(n,1);var e=c(t.fromId),r=c(t.toId);return e&&(n=o(t,e.links),n>=0&&e.links.splice(n,1)),r&&(n=o(t,r.links),n>=0&&r.links.splice(n,1)),O(t,"remove"),j(),!0}function x(t,n){var e,r=c(t);if(!r||!r.links)return null;for(e=0;e<r.links.length;++e){var o=r.links[e];if(o.fromId===t&&o.toId===n)return o}return null}function m(){X(),C(function(t){d(t.id)}),j()}function b(t){var n,e;if("function"==typeof t)for(n=0,e=B.length;n<e;++n)t(B[n])}function q(t,n,e){var r=c(t);if(r&&r.links&&"function"==typeof n)return e?w(r.links,t,n):k(r.links,t,n)}function k(t,n,e){for(var r,o=0;o<t.length;++o){var i=t[o],s=i.fromId===n?i.toId:i.fromId;if(r=e(E[s],i))return!0}}function w(t,n,e){for(var r,o=0;o<t.length;++o){var i=t[o];if(i.fromId===n&&(r=e(E[i.toId],i)))return!0}}function I(){}function M(){D+=1}function P(){D-=1,0===D&&_.length>0&&(F.fire("changed",_),_.length=0)}function z(){return Object.keys?N:L}function N(t){if("function"==typeof t)for(var n=Object.keys(E),e=0;e<n.length;++e)if(t(E[n[e]]))return!0}function L(t){if("function"==typeof t){var n;for(n in E)if(t(E[n]))return!0}}t=t||{},void 0===t.uniqueLinkId&&(t.uniqueLinkId=!0);var E="function"==typeof Object.create?Object.create(null):{},B=[],A={},U=0,D=0,C=z(),V=t.uniqueLinkId?y:l,_=[],O=I,S=I,X=I,j=I,F={addNode:u,addLink:h,removeLink:v,removeNode:d,getNode:c,getNodesCount:function(){return U},getLinksCount:function(){return B.length},getLinks:g,forEachNode:C,forEachLinkedNode:q,forEachLink:b,beginUpdate:X,endUpdate:j,clear:m,hasLink:x,getLink:x};return p(F),n(),F}function o(t,n){if(!n)return-1;if(n.indexOf)return n.indexOf(t);var e,r=n.length;for(e=0;e<r;e+=1)if(n[e]===t)return e;return-1}function i(t){this.id=t,this.links=null,this.data=null}function s(t,n){t.links?t.links.push(n):t.links=[n]}function a(t,n,e,r){this.fromId=t,this.toId=n,this.data=e,this.id=r}function u(t){var n,e,r,o=0;if(0==t.length)return o;for(n=0,r=t.length;n<r;n++)e=t.charCodeAt(n),o=(o<<5)-o+e,o|=0;return o}function f(t,n){return u(t.toString()+"👉 "+n.toString())}n.exports=r;var p=t("ngraph.events")},{"ngraph.events":31}],31:[function(t,n,e){arguments[4][11][0].apply(e,arguments)},{dup:11}]},{},[1])(1)});